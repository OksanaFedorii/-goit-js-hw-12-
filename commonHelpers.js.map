{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '43843798-e4c61f3cfe0ada13281a73887';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport const fetchPhotosByQuery = async (q, page = 1) => {\n    const searchParams = new URLSearchParams({\n        q,\n        key: API_KEY,\n        per_page: 15,\n        image_type: \"photo\",\n        orientation: 'horizontal',\n        safesearch: true,\n        page\n    });\n\n    try {\n        const response = await axios.get(`${BASE_URL}?${searchParams}`);\n        return response.data;\n    } catch (error) {\n        throw new Error('Network response was not ok');\n    }\n};\n","export function createGalleryItemMarkup(items) {\n    return items.map(item => `\n        <a href=\"${item.largeImageURL}\" class=\"gallery-item\" data-lightbox=\"gallery\">\n            <img src=\"${item.webformatURL}\" alt=\"${item.tags}\" />\n            <div class=\"card-body\">\n              <ul class=\"list-group list-group-flush\">\n                <li class=\"list-group-item\"><strong>Likes</strong> ${item.likes}</li>\n                <li class=\"list-group-item\"><strong>Views</strong> ${item.views}</li>\n                <li class=\"list-group-item\"><strong>Comments</strong> ${item.comments}</li>\n                <li class=\"list-group-item\"><strong>Downloads</strong> ${item.downloads}</li>\n              </ul>\n            </div>\n        </a>   \n    `).join('');\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\nimport { createGalleryItemMarkup } from './js/render-function.js';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\nlet loadedHits = 0;\n\ndocument.addEventListener('DOMContentLoaded', function () {\n    const form = document.querySelector('.js-search-form');\n    const galleryEl = document.querySelector('.js-gallery');\n    const loaderEl = document.querySelector('.js-loader');\n    const loadMoreBtn = document.querySelector('.js-load-more');\n\n    if (!form || !galleryEl || !loaderEl || !loadMoreBtn) {\n        console.error('One or more elements were not found in the DOM.');\n        return;\n    }\n\n    form.addEventListener('submit', async function (event) {\n        event.preventDefault();\n        const input = document.querySelector('.js-search-input');\n        const searchQuery = input.value.trim();\n\n        if (searchQuery === '') {\n            galleryEl.innerHTML = '';\n            input.value = '';\n            iziToast.show({\n                message: 'Input field can not be empty',\n                position: 'topRight',\n                timeout: 2000,\n                color: 'red',\n            });\n            return;\n        }\n\n        galleryEl.innerHTML = '';\n        loaderEl.classList.remove('is-hidden');\n        loadMoreBtn.classList.add('is-hidden');\n        currentPage = 1;\n        currentQuery = searchQuery;\n        loadedHits = 0;\n\n        try {\n            const data = await fetchPhotosByQuery(currentQuery, currentPage);\n            totalHits = data.totalHits;\n            loadedHits += data.hits.length;\n\n            if (totalHits === 0) {\n                iziToast.show({\n                    message: 'Sorry, there are no images for this query',\n                    position: 'topRight',\n                    timeout: 2000,\n                    color: 'red',\n                });\n            } else {\n                galleryEl.innerHTML = createGalleryItemMarkup(data.hits);\n                initializeLightbox();\n                if (loadedHits < totalHits) {\n                    loadMoreBtn.classList.remove('is-hidden');\n                }\n            }\n        } catch (error) {\n            console.error('Fetch error:', error);\n            iziToast.show({\n                message: 'Failed to load images',\n                position: 'topRight',\n                timeout: 2000,\n                color: 'red',\n            });\n        } finally {\n            input.value = '';\n            loaderEl.classList.add('is-hidden');\n        }\n    });\n\n    loadMoreBtn.addEventListener('click', async function () {\n        currentPage += 1;\n        loaderEl.classList.remove('is-hidden');\n        loadMoreBtn.classList.add('is-hidden');\n\n        try {\n            const data = await fetchPhotosByQuery(currentQuery, currentPage);\n            loadedHits += data.hits.length;\n            galleryEl.insertAdjacentHTML('beforeend', createGalleryItemMarkup(data.hits));\n            initializeLightbox();\n\n            const { height: cardHeight } = document.querySelector('.gallery-item').getBoundingClientRect();\n            window.scrollBy({\n                top: cardHeight * 2,\n                behavior: 'smooth',\n            });\n\n            if (loadedHits < totalHits) {\n                loadMoreBtn.classList.remove('is-hidden');\n            } else {\n                iziToast.show({\n                    message: \"We're sorry, but you've reached the end of search results.\",\n                    position: 'topRight',\n                    timeout: 2000,\n                    color: 'blue',\n                });\n            }\n        } catch (error) {\n            console.error('Fetch error:', error);\n            iziToast.show({\n                message: 'Failed to load more images',\n                position: 'topRight',\n                timeout: 2000,\n                color: 'red',\n            });\n        } finally {\n            loaderEl.classList.add('is-hidden');\n        }\n    });\n});\n\nfunction initializeLightbox() {\n    const lightbox = new SimpleLightbox('.gallery a', {\n        overlayOpacity: 1,\n        captionsData: 'alt',\n        captionsDelay: 250,\n        nav: true,\n        close: true,\n        showCounter: true,\n        animationSpeed: 300,\n        fadeSpeed: 300,\n    });\n\n    lightbox.refresh();\n} \n\n"],"names":["API_KEY","BASE_URL","fetchPhotosByQuery","q","page","searchParams","axios","createGalleryItemMarkup","items","item","currentPage","currentQuery","totalHits","loadedHits","form","galleryEl","loaderEl","loadMoreBtn","event","input","searchQuery","iziToast","data","initializeLightbox","error","cardHeight","SimpleLightbox"],"mappings":"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"}